<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Persistent EJB timers :: Payara Documentation Preview</title>
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../../../../../_/css/site.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@alpha" />
    <meta name="docsearch:version" content="5.36.0" />
  </head>
  <body class="article">
  <header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../../..">Payara Documentation Preview</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-item hide-for-print">
        Version: <div class="page-versions">
  <button class="version-menu-toggle single-version" title="Current version">5.36.0</button>
</div>

      </div>
      <div class="navbar-item hide-for-print">
            <div id="search-input-container">
    </div>
      </div>

      <div class="navbar-end">
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://www.payara.fish/products/downloads/">Download</a>
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary enterprise" href="../../../../../../enterprise">Documentation for Payara Enterprise</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="5.36.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">docs</span>
    <span class="version">5.36.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../index.html">5.36.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../Overview.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../index.html">docs</a></li>
    <li><a href="Persistent%20EJB%20Timers.html">Persistent EJB timers</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/alanroth/Workspace/ondro-poc/docs/modules/ROOT/pages/Technical%20Documentation/Payara%20Micro%20Documentation/Extensions/Persistent%20EJB%20Timers.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Persistent EJB timers</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Payara Micro Community supports persistent EJB timers which are stored across Payara Micro Community
instances within the cluster, backed by distributed Hazelcast cache.</p>
</div>
<div class="paragraph">
<p>The timers are persisted as long as the cluster is running, even when the member
that created the timer goes down.</p>
</div>
<div class="paragraph">
<p>In order to make use of a persistent timer in Payara Micro Community, an application must
declare a timer to be persistent, as defined by the EJB specification.
This is actually the default behavior, unless timers are specified as <strong>non-persistent</strong>.</p>
</div>
<div class="paragraph">
<p>The second requirement is to specify a name for every Payara Micro Community instance which
runs an application with persistent timers. Each such instance has to have its
own unique name.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Persistent timers are <strong>NOT</strong> coordinated across a Payara Micro cluster.
They are always executed on an instance with the same name that created the timers.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="requirements-to-setup-a-persistent-timer"><a class="anchor" href="#requirements-to-setup-a-persistent-timer"></a>Requirements to setup a persistent timer</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The timer has to be persistent, i.e. the value of <code>persistent</code> attribute is
not forcibly set to <code>false</code></p>
</li>
<li>
<p>A Payara Micro instance is given a unique name using <code>--name</code> argument</p>
</li>
<li>
<p>A Payara Micro instance is a member of a Hazelcast cluster</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Hazelcast cluster can be formed by other Payara Micro instances, Payara Server
instances with Hazelcast turned on, or by standalone Hazelcast instances.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="how-ejb-timers-are-persisted"><a class="anchor" href="#how-ejb-timers-are-persisted"></a>How EJB timers are persisted</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once timers are scheduled, either by the <code>@Schedule</code> annotation or using the
<code>TimerService</code>, the schedule is stored into the Hazelcast distributed cache.
The schedule is given a key, which is the name of the Payara Micro instance that
created the timer. If that instance goes down, the timer will be recreated on
another instance with the same name once it joins the cluster. Until that time,
the timer becomes inactive.</p>
</div>
<div class="paragraph">
<p>The timer would not be recreated on other members of the cluster or any new
members of the cluster with a different name.</p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../../_/js/site.js"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../../_/js/vendor/docSearch.js"></script>
  </body>
</html>
