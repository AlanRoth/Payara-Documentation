<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Payara Micro Docker Image Overview :: Payara Documentation Preview</title>
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../../../../../_/css/site.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@alpha" />
    <meta name="docsearch:version" content="5.36.0" />
  </head>
  <body class="article">
  <header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../../..">Payara Documentation Preview</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-item hide-for-print">
        Version: <div class="page-versions">
  <button class="version-menu-toggle single-version" title="Current version">5.36.0</button>
</div>

      </div>
      <div class="navbar-item hide-for-print">
            <div id="search-input-container">
    </div>
      </div>

      <div class="navbar-end">
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://www.payara.fish/products/downloads/">Download</a>
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary enterprise" href="../../../../../../enterprise">Documentation for Payara Enterprise</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="5.36.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">docs</span>
    <span class="version">5.36.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../index.html">5.36.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../Overview.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../index.html">docs</a></li>
    <li><a href="micro-image-overview.html">Payara Micro Docker Image Overview</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/alanroth/Workspace/Payara-Documentation/docs/modules/ROOT/pages/Technical%20Documentation/Payara%20Micro%20Documentation/Payara%20Micro%20Docker%20Image/micro-image-overview.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Payara Micro Docker Image Overview</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Overview of the usage and details of the official Payara Micro Community Docker image.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="quickstart"><a class="anchor" href="#quickstart"></a>Quick start</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Launch a new Payara Micro instance running in a container listening in port <code>8080</code> with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker run -p 8080:8080 payara/micro</code></pre>
</div>
</div>
<div class="paragraph">
<p>Keep in mind the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The instance will start with no deployed applications.</p>
</li>
<li>
<p>Accessing the default HTTP endpoint will yield a <code>404 - Not Found</code> response.</p>
</li>
<li>
<p>The instance&#8217;s JVM process runs under the <code>payara</code> user.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Using a specific version</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker run -p 8080:8080 payara/micro:{currentVersion}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jdk-version"><a class="anchor" href="#jdk-version"></a>Specifying the JDK Version</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are 2 different, alternative versions of the JDK images:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The default version which is based on <strong>JDK8</strong>, uses no suffix.</p>
</li>
<li>
<p>The <strong>JDK 11</strong> version, which uses the <code>-jdk11</code> suffix.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To switch from the default JDK 8 based image to the JDK 11 compatible one, just add the corresponding suffix to the tag&#8217;s name like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker run -p 8080:8080 payara/micro:{currentVersion}-jdk11</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ports"><a class="anchor" href="#ports"></a>Exposed ports</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default ports that are exposed by this image are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>8080 - HTTP listener</p>
</li>
<li>
<p>6900 - Datagrid&#8217;s Hazelcast port</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation-details"><a class="anchor" href="#installation-details"></a>Installation Details</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Payara Micro JAR file is located in the <code>/opt/payara/</code> directory (identified by the <code>HOME_DIR</code> environment variable), which also is the default work directory of the image.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The directory name is deliberately free of any versioning so that any scripts written to work with one version can be seamlessly migrated to the latest docker image.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="application-deployment"><a class="anchor" href="#application-deployment"></a>Application Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Payara Micro will deploy applications at startup time, depending on how you prefer to instruct the instance to execute the deployments. However, you have to make sure that the container has access to your application artefacts.</p>
</div>
<div class="paragraph">
<p>You can instruct the container to deploy applications using the following mechanisms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mount a deployment directory (local or in the network) as a Docker volume</p>
</li>
<li>
<p>Prepare a custom Docker image that includes your application artefacts.</p>
</li>
<li>
<p>Deploy your applications from a remote Maven repository.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="deploy-from-directory"><a class="anchor" href="#deploy-from-directory"></a>Deploy Applications from a Directory</h3>
<div class="paragraph">
<p>You can instruct the container to deploy all application artefacts that belong to a directory that is mounted as Docker volume mapped to the <code>/opt/payara/deployments</code> (which is defined as the value of the <code>$DEPLOY_DIR</code> environment variable) local directory.</p>
</div>
<div class="paragraph">
<p>The following command will start a new Payara Micro instance container and deploy all artefacts located in the <code>~/payara-micro/applications</code> directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker run -p 8080:8080 \
 -v ~/payara-micro/applications:/opt/payara/deployments payara/micro</code></pre>
</div>
</div>
<div class="paragraph">
<p>To only deploy a specific artefact within the directory, simply pass the <code>--deploy</code> argument to the container&#8217;s run command and specify which application to deploy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker run -p 8080:8080 \
 -v ~/payara-micro/applications:/opt/payara/deployments \
 payara/micro --deploy /opt/payara/deployments/myapplication.war</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Make sure to prefix the artefact names with the absolute path to the local deployment directory.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="deploy-using-custom-image"><a class="anchor" href="#deploy-using-custom-image"></a>Deploy Applications using a Custom Image</h3>
<div class="paragraph">
<p>You can also prepare a custom image based on the official Payara Micro Docker image and copy all application artefacts to the <code>$DEPLOY_DIR</code> directory. This way, you can re-package your applications in a simple distributable unit.</p>
</div>
<div class="paragraph">
<p>The following sample <em>Dockerfile</em> can be used to prepare a custom Payara Micro image that deploys the <code>myapplication.war</code> artefact at runtime:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-Docker hljs" data-lang="Docker">FROM payara/micro
COPY myapplication.war $DEPLOY_DIR</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deploy-from-maven-repo"><a class="anchor" href="#deploy-from-maven-repo"></a>Deploy Applications from a Maven Repository</h3>
<div class="paragraph">
<p>If your application&#8217;s artefact is already available in a Maven repository, you can instruct the container to download and deploy it directly. To do this, you&#8217;ll have to pass the <code>--deployFromGAV</code> argument with the GAV coordinates of your artefact to the run command used to launch the container.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of how to deploy a sample application located in a local Maven repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker run -p 8080:8080 payara/micro \
 --deployFromGAV "fish.payara.examples:my-application:1.0-SNAPSHOT" \
 --additionalRepository https://172.17.0.10/content/repositories/snapshots</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that the example also uses the <code>--additionalRepository</code> argument to specify the URL of the repository where the artefact lives since by default, Payara Micro will only look for artefacts in the Maven Central repository.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration"><a class="anchor" href="#configuration"></a>Configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="context-root"><a class="anchor" href="#context-root"></a>Context Root Configuration</h3>
<div class="paragraph">
<p>By default, the context root of each deployed application corresponds to the artefact&#8217;s file name. You can override this setting by using the <code>--contextroot</code> startup argument.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To deploy an application using the default context root (<code>/</code>), set its value to <code>ROOT</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here are some basic examples:</p>
</div>
<div class="listingblock">
<div class="title">One application deployed, uses the <code>myRoot</code> context root</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker run -p 8080:8080 \
 -v ~/payara-micro/applications:/opt/payara/deployments payara/micro  \
--deploymentDir /opt/payara/deployments  \
 --contextroot myRoot</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">First application in the directory uses the <code>/</code> context root</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker run -p 8080:8080 \
 -v ~/payara-micro/applications:/opt/payara/deployments \
 payara/micro \
 --deploy /opt/payara/deployments/myapplication.war \
 --contextroot ROOT</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also prepare a custom Docker image that overrides the default <code>CMD</code> instruction to specify the context root like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-Docker hljs" data-lang="Docker">FROM payara/micro
COPY myapplication.war $DEPLOY_DIR
CMD ["--deploymentDir", "/opt/payara/deployments", "--contextroot", "my"]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="disabling-data-grid"><a class="anchor" href="#disabling-data-grid"></a>Disable the Data Grid</h3>
<div class="paragraph">
<p>Payara Micro will start in "clustering" mode by booting up the <a href="../Payara%20Micro%20Configuration%20and%20Management/Micro%20Management/Clustering.html" class="page">Data Grid</a>, allowing other instances reachable in the network to join the grid automatically.</p>
</div>
<div class="paragraph">
<p>The Data Grid initialization and maintenance consumes extra resources, so in cases where clustering is not needed, it is recommended to disable the Data Grid completely.</p>
</div>
<div class="paragraph">
<p>To disable the Data Grid, you can pass the <code>--noCluster</code> argument to the entry point of the run command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker run -p 8080:8080 \
 -v ~/payara-micro/applications:/opt/payara/deployments payara/micro --noCluster</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-environment-variables"><a class="anchor" href="#using-environment-variables"></a>Using Environment Variables</h3>
<div class="paragraph">
<p>The following environment variables can be used to configure multiple settings of the Payara Micro instance. They can be either specified in a custom image&#8217;s <code>Dockerfile</code> or passed to the <code>docker run</code> command via the <code>--env</code> or <code>--env-file</code> arguments:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.9999%;">
<col style="width: 50%;">
<col style="width: 21.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MEM_MAX_RAM_PERCENTAGE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value for the JVM argument <code>-XX:MaxRAMPercentage</code> which indicates the percentage of memory assigned to the container that can be used by the Java process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>70</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MEM_XSS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value for the JVM argument <code>-Xss</code> which controls the stack size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>512K</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JVM_ARGS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional JVM arguments which will be used to configure the Payara Servers DAS JVM settings</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following is a list of variables used by the Docker image to set up the Payara Micro instance startup, so it is not recommended to alter their values:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.9999%;">
<col style="width: 50%;">
<col style="width: 21.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HOME_DIR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The directory containing the Payara Micro JAR binary and the scripts used to run the instance.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opt/payara</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../../_/js/site.js"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../../_/js/vendor/docSearch.js"></script>
  </body>
</html>
