<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Payara Server Docker Image Overview :: Payara Documentation Preview</title>
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../../../../../_/css/site.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@alpha" />
    <meta name="docsearch:version" content="5.36.0" />
  </head>
  <body class="article">
  <header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../../..">Payara Documentation Preview</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-item hide-for-print">
        Version: <div class="page-versions">
  <button class="version-menu-toggle single-version" title="Current version">5.36.0</button>
</div>

      </div>
      <div class="navbar-item hide-for-print">
            <div id="search-input-container">
    </div>
      </div>

      <div class="navbar-end">
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://www.payara.fish/products/downloads/">Download</a>
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary enterprise" href="../../../../../../enterprise">Documentation for Payara Enterprise</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="5.36.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">docs</span>
    <span class="version">5.36.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../index.html">5.36.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../Overview.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../index.html">docs</a></li>
    <li><a href="server-image-overview.html">Payara Server Docker Image Overview</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/alanroth/Workspace/ondro-poc/docs/modules/ROOT/pages/Technical%20Documentation/Payara%20Server%20Documentation/Payara%20Server%20Docker%20Image/server-image-overview.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Payara Server Docker Image Overview</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Overview of the usage and details of the official Payara Server Community Docker image.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="quickstart"><a class="anchor" href="#quickstart"></a>Quick start</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Launch a new Payara Server domain running in a container listening in port <code>8080</code> with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker run -p 8080:8080 payara/server-full</code></pre>
</div>
</div>
<div class="paragraph">
<p>Keep in mind the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The container starts the <code>domain1</code> domain in the foreground so the server&#8217;s DAS becomes the main process.</p>
</li>
<li>
<p>The <em>tini</em> utility is used to guarantee that the server runs seamlessly as the single child process.</p>
</li>
<li>
<p>The server&#8217;s JVM process runs under the <code>payara</code> user.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Using a specific version</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker run -p 8080:8080 payara/server-full:{currentVersion}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="other-distributions"><a class="anchor" href="#other-distributions"></a>Other distributions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Besides the Full Profile version, the Payara Server Web Profile distribution is also available as a Docker Image under the <code>payara/server-web</code> name. The image for this distribution behaves the same as its Full Profile counterpart.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jdk-version"><a class="anchor" href="#jdk-version"></a>Specifying the JDK Version</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are 2 different, alternative versions of the JDK images:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The default version which is based on <strong>JDK8</strong>, uses no suffix.</p>
</li>
<li>
<p>The <strong>JDK 11</strong> version, which uses the <code>-jdk11</code> suffix.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To switch from the default JDK 8 based image to the JDK 11 compatible one, just add the corresponding suffix to the tag&#8217;s name like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker run -p 8080:8080 payara/server-full:{currentVersion}-jdk11</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ports"><a class="anchor" href="#ports"></a>Exposed ports</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default ports that are exposed by this image are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>8080 - HTTP listener</p>
</li>
<li>
<p>8181 - HTTPS listener</p>
</li>
<li>
<p>4848 - Admin Service HTTPS listener</p>
</li>
<li>
<p>9009 - JWDP Debug port</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="administration"><a class="anchor" href="#administration"></a>Administration Details</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To access the DAS' administration interface (either by remote asadmin commands or by using the Web Admin Console), just map the container&#8217;s Admin Service port when launching the container:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker run -p 4848:4848 -p 8080:8080 payara/server-full</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the admin service will be secure-enabled, meaning that HTTPS communication will be used exclusively.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The default administrator user with access to the admin interface will use the <code>admin/admin</code> credentials.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
If you plan to use this image in a production environment, make sure to update these credentials after the domain has started.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation-details"><a class="anchor" href="#installation-details"></a>Installation Details</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Payara Server installation is located in the <code>/opt/payara/appserver</code> directory (identified by the <code>PAYARA_DIR</code> environment variable). The <code>/opt/payara/</code> parent directory is the default working directory of the docker image.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The directory name is deliberately free of any versioning so that any scripts written to work with one version can be seamlessly migrated to the latest docker image.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="application-deployment"><a class="anchor" href="#application-deployment"></a>Application Deployment</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="deploy-from-directory"><a class="anchor" href="#deploy-from-directory"></a>Deploy Applications from a Directory</h3>
<div class="paragraph">
<p>The default entrypoint will scan the <code>$DEPLOY_DIR</code> directory (which defaults to <code>/opt/payara/deployments</code>) for files and sub-folders and deploy them automatically after the domain is started.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Any RAR files artefacts found in the directory will always be deployed first
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To deploy your applications, you can mount this directory as a Docker volume mapped to a local directory that hosts your application artefacts.</p>
</div>
<div class="paragraph">
<p>The following sample command will launch a new Payara Server container and deploy all applications located in the <code>~/payara/apps</code> directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>docker run -p 8080:8080 -v ~/payara/apps:/opt/payara/deployments payara/server-full</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deploy-using-custom-image"><a class="anchor" href="#deploy-using-custom-image"></a>Deploy Applications using a Custom Image</h3>
<div class="paragraph">
<p>You can also prepare a custom image based on the official Payara Server Docker image and copy all application artifacts to the <code>$DEPLOY_DIR</code> directory. This way, you can re-package your applications in a simple distributable unit.</p>
</div>
<div class="paragraph">
<p>The following sample <em>Dockerfile</em> can be used to prepare a custom Payara Server image that deploys the <code>myapplication.war</code> artefact at runtime:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-Docker hljs" data-lang="Docker">FROM payara/server-full
COPY myapplication.war $DEPLOY_DIR</code></pre>
</div>
</div>
<div class="paragraph">
<p>And to launch the container, simply build and run the image like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker build -t mycompany/myapplication:1.0 .
docker run -p 8080:8080 mycompany/myapplication:1.0</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration"><a class="anchor" href="#configuration"></a>Configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="using-environment-variables"><a class="anchor" href="#using-environment-variables"></a>Using Environment Variables</h3>
<div class="paragraph">
<p>The following environment variables can be used to configure multiple settings of the Payara Server&#8217;s DAS before the domain is started. They can be either specified in a custom image&#8217;s <code>Dockerfile</code>, passed to the <code>docker run</code> command via the <code>--env</code> or <code>--env-file</code> arguments or modified by an init script before the <code>startInForeground.sh</code> script is executed:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.9999%;">
<col style="width: 50%;">
<col style="width: 21.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PREBOOT_COMMANDS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the file containing commands to be executed before the domain is started. The file will not be modified by the Docker container</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$CONFIG_DIR/post-boot-commands.asadmin</code> and <code>$CONFIG_DIR/pre-boot-commands.asadmin</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>POSTBOOT_COMMANDS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the file containing commands to be executed after the domain is started. This is the file written to in the <code>generate_deploy_commands.sh</code> script. The file will not be modified by the Docker container</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$CONFIG_DIR/post-boot-commands.asadmin</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MEM_MAX_RAM_PERCENTAGE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value for the JVM argument <code>-XX:MaxRAMPercentage</code> which indicates the percentage of memory assigned to the container that can be used by the Java process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>70</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MEM_XSS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value for the JVM argument <code>-Xss</code> which controls the stack size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>512K</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DEPLOY_PROPS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a list of properties to be passed with the deploy commands generated in the <code>generate_deploy_commands.sh</code> script</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PAYARA_ARGS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional arguments passed to the <code>start-domain</code> command that starts the DAS. <em>Use with caution.</em></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JVM_ARGS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional JVM arguments which will be used to configure the Payara Servers DAS JVM settings</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Preboot and post-boot command files will not be modified by the Docker container.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following is a list of variables used by the Docker image to configure the Payara Server domain, so it is not recommended to alter their values:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.9999%;">
<col style="width: 50%;">
<col style="width: 21.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HOME_DIR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The home directory for the <code>payara</code> user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opt/payara</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PAYARA_DIR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The root directory of the Payara installation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opt/payara/appserver</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SCRIPT_DIR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The directory where the <code>generate_deploy_commands.sh</code> and <code>startInForeground.sh</code> scripts can be found</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opt/payara/scripts</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CONFIG_DIR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The directory where the post and pre boot files are generated to by default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opt/payara/config</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DEPLOY_DIR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The directory where applications are searched for in <code>generate_deploy_commands.sh</code> script</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opt/payara/deployments</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ADMIN_USER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The default username credential for the default administrator user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>admin</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ADMIN_PASSWORD</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The default password credential for the default administrator user. Can only be set when the basic image is created</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>admin</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PASSWORD_FILE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The location of the password file for asadmin. This can be passed to asadmin using the <code>--passwordfile</code> parameter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opt/payara/passwordFile</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DOMAIN_NAME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the domain running within the container</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>domain1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AS_ADMIN_MASTERPASSWORD</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The master password to pass to Payara Server. This is overridden if one is specified in the <code>$PASSWORD_FILE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>changeit</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="executing-admin-commands-domain-startup"><a class="anchor" href="#executing-admin-commands-domain-startup"></a>Executing Administration Commands at Domain Startup</h3>
<div class="paragraph">
<p>It’s possible to run a set of custom administration commands during the domain startup. You can either specify the <code>PREBOOT_COMMANDS</code> or <code>POSTBOOT_COMMANDS</code> environment variables to point to the absolute path of a custom script file, or you can just copy the file to the expected paths (See above).</p>
</div>
<div class="paragraph">
<p>For example, the following sample command will execute all commands listed in the <code>post-boot-commands.asadmin</code> file inside the <code>/local/path/with/boot/file</code> directory mounted volume:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker run -p 8080:8080 -v /local/path/with/boot/file:/config -e POSTBOOT_COMMANDS=/config/post-boot-commands.asadmin payara/server-full</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, the same outcome can be achieved by defining a custom Docker image:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-Docker hljs" data-lang="Docker">FROM payara/server-full
COPY post-boot-commands.asadmin $POSTBOOT_COMMANDS</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="executing-custom-scripts-before-domain-startup"><a class="anchor" href="#executing-custom-scripts-before-domain-startup"></a>Executing Custom Scripts before Domain Startup</h3>
<div class="paragraph">
<p>If preboot command files are not enough, you can add your customized shell scripts to the <code>${SCRIPT_DIR}/init.d</code> directory. This will allow you to modify the environment before the Payara Server domain starts.</p>
</div>
<div class="paragraph">
<p>Scripts added to this folder should be <a href="https://www.gnu.org/software/bash/">Bash</a> scripts and they should end with the <code>.sh</code> suffix.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Scripts in <code>${SCRIPT_DIR}/init.d</code> will be executed in the standard file order. If you need to start them in a specific order, we recommend prepending a prefix number to their name, for example, <code>01_script1.sh</code>, <code>02_script2.sh</code>, and so on.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As with the preboot command file, you may either create a custom Docker image that already contains the script files in question or you can also mount a volume mapped to the <code>${SCRIPT_DIR}/init.d</code> directory instead.</p>
</div>
</div>
<div class="sect2">
<h3 id="default-entrypoint"><a class="anchor" href="#default-entrypoint"></a>The Default Docker Entrypoint</h3>
<div class="paragraph">
<p>The default entry point of the Docker image is defined using the <a href="https://github.com/krallin/tini">tini utility</a>, to allow the DAS&#8217;s JVM to run as a single child process.</p>
</div>
<div class="paragraph">
<p>The default <code>CMD</code> argument for <em>tini</em> runs the <code>bin/entrypoint.sh</code> shell script in <code>exec</code> mode, which in turn runs the following scripts in order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>${SCRIPT_DIR}/init_1_generate_deploy_commands.sh</code>: This script outputs deploy commands to the post-boot command file located at <code>$POSTBOOT_COMMANDS</code> (default <code>$CONFIG_DIR/post-boot-commands.asadmin</code>). If deploy commands are already found in that file, this script does nothing.</p>
</li>
<li>
<p><code>${SCRIPT_DIR}/init.d/<strong>.sh</code>: As described above, these scripts can be provided by you to run and configure the environment *before</strong> the domain startup.</p>
</li>
<li>
<p><code>${SCRIPT_DIR}/startInForeground.sh</code>. This script starts the domain in the foreground, in a manner that allows the JVM to be controlled by the docker host.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="browsing-container"><a class="anchor" href="#browsing-container"></a>Browsing the Container</h3>
<div class="paragraph">
<p>You can override the default entrypoint if needed to test or browse the container to examine that everything&#8217;s in place. The following command will start the container at a bash prompt, without starting the domain.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker run -p 8080:8080 -it payara/server-full bash</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../../_/js/site.js"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../../_/js/vendor/docSearch.js"></script>
  </body>
</html>
