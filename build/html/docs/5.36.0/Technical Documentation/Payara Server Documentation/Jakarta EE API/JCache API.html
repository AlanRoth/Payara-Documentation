<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JCache in Payara Server :: Payara Documentation Preview</title>
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../../../../../_/css/site.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@alpha" />
    <meta name="docsearch:version" content="5.36.0" />
  </head>
  <body class="article">
  <header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../../..">Payara Documentation Preview</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-item hide-for-print">
        Version: <div class="page-versions">
  <button class="version-menu-toggle single-version" title="Current version">5.36.0</button>
</div>

      </div>
      <div class="navbar-item hide-for-print">
            <div id="search-input-container">
    </div>
      </div>

      <div class="navbar-end">
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://www.payara.fish/products/downloads/">Download</a>
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary enterprise" href="../../../../../../enterprise">Documentation for Payara Enterprise</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="5.36.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">docs</span>
    <span class="version">5.36.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../index.html">5.36.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../Overview.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../index.html">docs</a></li>
    <li><a href="JCache%20API.html">JCache in Payara Server</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/alanroth/Workspace/ondro-poc/docs/modules/ROOT/pages/Technical%20Documentation/Payara%20Server%20Documentation/Jakarta%20EE%20API/JCache%20API.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">JCache in Payara Server</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This section covers how to use the JCache functionality in Payara Server.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<em>JSR107 (JCache)</em> is implemented in Payara Server by Hazelcast IMDG.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="accessing-the-caching-provider-and-cache-manager"><a class="anchor" href="#accessing-the-caching-provider-and-cache-manager"></a>Accessing the Caching Provider and Cache Manager</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To create a <code>Cache</code> instance you will need to access either a <code>CachingProvider</code> or a <code>CacheManager</code> instance at runtime. This can be done either declaratively via CDI injection or programmatically via JNDI lookup.</p>
</div>
<div class="sect2">
<h3 id="using-injection"><a class="anchor" href="#using-injection"></a>Using Injection</h3>
<div class="paragraph">
<p>You can inject both <code>CachingProvider</code> and <code>CacheManager</code> instances in any CDI beans like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import javax.cache.CacheManager;
import javax.cache.spi.CachingProvider;
import javax.inject.Inject;
...
@Inject
CacheManager manager;
@Inject
CachingProvider provider;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Your WAR or JAR artifact must be an implicit or explicit bean archive.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="using-jndi"><a class="anchor" href="#using-jndi"></a>Using JNDI</h3>
<div class="paragraph">
<p>Both the <code>CachingProvider</code> and the <code>CachingManager</code> components can also be programmatically accessed through their JNDI names as well:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import javax.cache.spi.CachingProvider;
import javax.cache.CacheManager;
...
Context ctx = new InitialContext();
CachingProvider provider = (CachingProvider) ctx.lookup("payara/CachingProvider");
CacheManager manager = (CacheManager) ctx.lookup("payara/CacheManager");</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-a-cache-instance"><a class="anchor" href="#creating-a-cache-instance"></a>Creating a Cache Instance</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can create a cache using either the <code>CacheManager.getCache</code> method, or by directly injecting the cache instance into a CDI bean.</p>
</div>
<div class="sect2">
<h3 id="using-injection-cache"><a class="anchor" href="#using-injection-cache"></a>Using Injection</h3>
<div class="paragraph">
<p>Injecting a cache into a CDI bean is simple enough:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import javax.inject.Inject;
import javax.cache.Cache;

@Inject
Cache cache;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The name of this cache will be the canonical name of the class it is created in.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Caches created in this way will also have JMX statistics and management enabled.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="typed-cache-injection"><a class="anchor" href="#typed-cache-injection"></a>Typed Cache Injection</h4>
<div class="paragraph">
<p>A typed cache can also be injected in the same manner:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import javax.inject.Inject;
import javax.cache.Cache;
...
@Inject
Cache&lt;Long, Property&gt; cache;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Both key and value types must be <code>Serializable</code> so that the cache can be properly instantiated at runtime.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="injecting-a-custom-cache"><a class="anchor" href="#injecting-a-custom-cache"></a>Injecting a Custom Cache</h3>
<div class="paragraph">
<p>You can determine the name and other attributes of a cache created through injection using the <code>@NamedCache</code> annotation.</p>
</div>
<div class="paragraph">
<p>For example, to inject a cache with a custom name and with JMX management enabled:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import fish.payara.cdi.jsr107.impl.NamedCache;
import javax.inject.Inject;
import javax.cache.Cache;
...
@NamedCache(cacheName = "custom", managementEnabled = true)
@Inject
Cache cache;</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This annotation is part of the <a href="../../Public%20API/Overview.html" class="page">Payara Platform Public API</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you only want to set the name of the cache but don&#8217;t want to depend on the <code>@NamedCache</code>, you can use the <code>@CacheDefaults</code> annotation on the bean class instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import javax.inject.Inject;
import javax.cache.Cache;
import javax.cache.annotation.CacheDefaults;
import javax.enterprise.context.ApplicationScoped;
...
@ApplicationScoped
@CacheDefaults(cacheName = "custom")
public class CacheBean {
    ...
    @Inject
    Cache cache;
    ...
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Keep in mind that this solution only works if your bean has one injected cache only. If you are in a situation where you must inject more than one cache into the bean then consider using the <code>@NamedCache</code> annotation to avoid name collisions.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-jcache-annotations"><a class="anchor" href="#using-jcache-annotations"></a>Using JCache Annotations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Payara Platform supports cache definitions and operations on caches by using the standard set of annotations that are part of the JCache API:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>@CachePut</code></dt>
<dd>
<p>Puts the specified key and value in the cache.</p>
</dd>
<dt class="hdlist1"><code>@CacheRemove</code></dt>
<dd>
<p>Removes an element from the cache that corresponds to the supplied key.</p>
</dd>
<dt class="hdlist1"><code>@CacheDefaults</code></dt>
<dd>
<p>Allows the configuration of defaults for <code>CacheResult</code>, <code>CachePut</code>, <code>CacheRemove</code>, and <code>CacheRemoveAll</code> at the class level.</p>
</dd>
<dt class="hdlist1"><code>@CacheKey</code></dt>
<dd>
<p>Marks a method parameter as the key of a cache.</p>
</dd>
<dt class="hdlist1"><code>@CacheValue</code></dt>
<dd>
<p>Marks a method parameter as the value of a cache key.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="see-also"><a class="anchor" href="#see-also"></a>See Also</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://javadoc.io/doc/javax.cache/cache-api/latest/index.html">JCache API Javadoc</a></p>
</li>
</ul>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../../_/js/site.js"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../../_/js/vendor/docSearch.js"></script>
  </body>
</html>
