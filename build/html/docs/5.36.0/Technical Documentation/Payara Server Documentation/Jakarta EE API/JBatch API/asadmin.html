<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Improved Asadmin Commands :: Payara Documentation Preview</title>
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../../../../../../_/css/site.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@alpha" />
    <meta name="docsearch:version" content="5.36.0" />
  </head>
  <body class="article">
  <header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../../../..">Payara Documentation Preview</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-item hide-for-print">
        Version: <div class="page-versions">
  <button class="version-menu-toggle single-version" title="Current version">5.36.0</button>
</div>

      </div>
      <div class="navbar-item hide-for-print">
            <div id="search-input-container">
    </div>
      </div>

      <div class="navbar-end">
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://www.payara.fish/products/downloads/">Download</a>
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary enterprise" href="../../../../../../../enterprise">Documentation for Payara Enterprise</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="5.36.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">docs</span>
    <span class="version">5.36.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../../index.html">5.36.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../Overview.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../../index.html">docs</a></li>
    <li><a href="asadmin.html">Improved Asadmin Commands</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/alanroth/Workspace/Payara-Documentation/docs/modules/ROOT/pages/Technical%20Documentation/Payara%20Server%20Documentation/Jakarta%20EE%20API/JBatch%20API/asadmin.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Improved Asadmin Commands</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The following is a list of the administration commands that have been introduced
or changed from GlassFish in Payara Server to improve the <strong>JBatch API</strong>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="set-batch-runtime-configuration"><a class="anchor" href="#set-batch-runtime-configuration"></a><code>set-batch-runtime-configuration</code></h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>Usage</strong></dt>
<dd>
<p><code>asadmin&gt; set-batch-runtime-configuration --datasourcelookupname="jdbc/default"
  --executorservicelookupname="concurrent/__defaultManagedExecutorService"
  --schemaName="APP" --tablePrefix="BJP" --tableSuffix="BJS"</code></p>
</dd>
<dt class="hdlist1"><strong>Aim</strong></dt>
<dd>
<p>Configures the batch runtime storage and execution settings.</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="command-options"><a class="anchor" href="#command-options"></a>Command Options</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 10%;">
<col style="width: 40%;">
<col style="width: 10%;">
<col style="width: 10%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Shortcut</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Mandatory</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--target</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The instance or cluster to configure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--datasourcelookupname</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The JNDI name of the JDBC data source used to store
job information</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes (unless <code>executorservicelookupname</code> is specified)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--executorservicelookupname</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The JNDI name of the Managed Executor Service
that provides threads for  the jobs' execution.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes (unless <code>datasourceLookupName</code> is used)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--schemaName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-n</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The database schema that holds the batch tables.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">APP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--tablePrefix</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The prefix to apply to the batch table name.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--tableSuffix</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the suffix to apply to the batch table name.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="example"><a class="anchor" href="#example"></a>Example</h3>
<div class="paragraph">
<p>The following command will set the data source, and the prefix and suffix for the
DAS:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin &gt; set-batch-runtime-configuration --target="server"
            --datasourcelookupname="jdbc/BatchJobsDS"
            --tablePrefix="BATCHJ_" --tableSuffix="_JB"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_purge_jakarta_ee_apijbatch_api_repository"><a class="anchor" href="#_purge_jakarta_ee_apijbatch_api_repository"></a><code>purge-Jakarta EE API/JBatch API-repository</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Since Payara Server 4.1.2.173</em></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>Usage</strong></dt>
<dd>
<p><code>asadmin&gt; purge-Jakarta EE API/JBatch API-repository &lt;apptag&gt;</code></p>
</dd>
<dt class="hdlist1"><strong>Aim</strong></dt>
<dd>
<p>Purges the current JBatch repository of all jobs scheduled for the referenced
application&#8217;s tag. The application&#8217;s tag is structured like this:</p>
<div class="listingblock">
<div class="content">
<pre>&lt;Configuration Identifier&gt;:&lt;Application Name&gt;__/&lt;Application Name&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Where <strong>Configuration Identifier</strong> is the identifier of the configuration associated
to the instance or cluster where the application is deployed and <strong>Application Name</strong>
is the name of the deployed application.</p>
</div>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="command-options-1"><a class="anchor" href="#command-options-1"></a>Command Options</h3>
<div class="paragraph">
<p>There are no options available.</p>
</div>
</div>
<div class="sect2">
<h3 id="example-1"><a class="anchor" href="#example-1"></a>Example</h3>
<div class="paragraph">
<p>To remove all current jobs for an application named <em>Jakarta EE API/JBatch API-test</em> deployed on the
DAS (<code>server-config</code>) then run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin &gt; purge-Jakarta EE API/JBatch API-repository "server-config:Jakarta EE API/JBatch API-test__/Jakarta EE API/JBatch API-test"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The command will remove all current jobs created by the referenced application
whether these jobs are running or not.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you are having trouble finding the application&#8217;s tag for your application,
you can get it programmatically on a Java EE application by using the following
code:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import com.ibm.Jakarta EE API/JBatch API.container.servicesmanager.ServicesManager;
import com.ibm.Jakarta EE API/JBatch API.container.servicesmanager.ServicesManagerImpl;
import com.ibm.Jakarta EE API/JBatch API.container.services.IPersistenceManagerService;
...

JobOperator jobOperator = getJobOperator();
Long executionId = jobOperator.start("job-name", new Properties());

ServicesManager manager = ServicesManagerImpl.getInstance();
IPersistenceManagerService ps = manager.getPersistenceManagerService();
String applicationTag = ps.getJobCurrentTag(jobid);</code></pre>
</div>
</div>
<div class="paragraph">
<p>You need to add a dependency to IBM&#8217;s <strong>JBatch runtime</strong> to your project to access
the classes mentioned:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.ibm.Jakarta EE API/JBatch API&lt;/groupId&gt;
    &lt;artifactId&gt;com.ibm.Jakarta EE API/JBatch API-runtime-all&lt;/artifactId&gt;
    &lt;version&gt;1.0&lt;/version&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>[[clean-Jakarta EE API/JBatch API-repository]]
== <code>clean-Jakarta EE API/JBatch API-repository</code></p>
</div>
<div class="paragraph">
<p><em>Since Payara Server 5.2021.1</em></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>Usage</strong></dt>
<dd>
<p><code>asadmin&gt; clean-Jakarta EE API/JBatch API-repository --status COMPLETED|ALL --days &lt;int.value&gt; &lt;JobName&gt;</code></p>
</dd>
<dt class="hdlist1"><strong>Aim</strong></dt>
<dd>
<p>The clean-Jakarta EE API/JBatch API-repository subcommand deletes records of job executions.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="command-options-clean"><a class="anchor" href="#command-options-clean"></a>Command Options</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Mandatory</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--status</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>ALL</p>
</li>
<li>
<p>COMPLETED</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The status of batch jobs executions to which delete the records of.
If ALL then all job executions will be deleted, regardless of status.
If COMPLETED only job executions that successfully completed will be deleted.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">COMPLETED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--days</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Integer</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of days previous that the end time of the job execution must be to get deleted.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="example-clean"><a class="anchor" href="#example-clean"></a>Example</h3>
<div class="paragraph">
<p>The following command will delete all Batch jobs that were executed before 7 days ago.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin &gt; clean-Jakarta EE API/JBatch API-repository --status=ALL --days=7 testjob</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="list-batch-jobs"><a class="anchor" href="#list-batch-jobs"></a><code>list-batch-jobs</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Since Payara Server 5.183</em></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>Usage</strong></dt>
<dd>
<p><code>asadmin&gt; list-batch-jobs --output jobname,appname,instancecount,instanceid,
executionid,batchstatus,starttime,endtime,exitstatus --limit &lt;long.value&gt;
--offset &lt;long.value&gt; --header true|false &lt;JobName&gt;</code></p>
</dd>
<dt class="hdlist1"><strong>Aim</strong></dt>
<dd>
<p>Lists batch jobs and information about them.</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="command-options-2"><a class="anchor" href="#command-options-2"></a>Command Options</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Shortcut</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Mandatory</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--target</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The instance or cluster to configure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-l</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shows detailed information about batch jobs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--output</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shows specific information about batch jobs. You can specify
information to display by using comma-separarted list. Following are the available
values: jobname, appname, instancecount, instanceid, executionid, batchstatus,
starttime, endtime, exitstatus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The jobname and instancecount information are
displayed by default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--header</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-h</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Option to choose whether column heading should be displayed or not</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--limit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set number of rows of batch jobs to display</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--offset</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set number of rows of batch jobs to skip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="example-2"><a class="anchor" href="#example-2"></a>Example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin &gt; list-batch-jobs --target server
            --long true
            --limit 20
            --offset 0</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../../../_/js/site.js"></script>
<script async src="../../../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../../../_/js/vendor/docSearch.js"></script>
  </body>
</html>
