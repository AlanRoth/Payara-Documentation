<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JDBC :: Payara Documentation Preview</title>
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../../../../../../_/css/site.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@alpha" />
    <meta name="docsearch:version" content="5.36.0" />
  </head>
  <body class="article">
  <header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../../../..">Payara Documentation Preview</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-item hide-for-print">
        Version: <div class="page-versions">
  <button class="version-menu-toggle single-version" title="Current version">5.36.0</button>
</div>

      </div>
      <div class="navbar-item hide-for-print">
            <div id="search-input-container">
    </div>
      </div>

      <div class="navbar-end">
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://www.payara.fish/products/downloads/">Download</a>
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary enterprise" href="../../../../../../../enterprise">Documentation for Payara Enterprise</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="5.36.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">docs</span>
    <span class="version">5.36.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../../index.html">5.36.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../Overview.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../../index.html">docs</a></li>
    <li><a href="JDBC.html">JDBC</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/alanroth/Workspace/Payara-Documentation/docs/modules/ROOT/pages/Technical%20Documentation/Payara%20Server%20Documentation/Server%20Configuration%20And%20Management/JDBC%20Resource%20Management/JDBC.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">JDBC</h1>
<div class="sect1">
<h2 id="configuring-a-connection-pool"><a class="anchor" href="#configuring-a-connection-pool"></a>Configuring a Connection Pool</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A connection pool is a store of database connections that can be used and (more importantly) re-used to connect to a RDBMS database. They help to improve both the performance and scalability of the system.</p>
</div>
<div class="paragraph">
<p>Rather than creating a new connection each time one is needed a pool of logical connections is created when Payara Server is started. When a new connection is required the pool is searched for an available connection. If one is available it is returned to the requester. If none is available then the request is either queued or a new connection is established depending on how many connections are already in the pool and how the pool is configured.</p>
</div>
<div class="paragraph">
<p>Once the connection is finished with, rather than closing it the connection is returned to the connection pool for use by the next requester.</p>
</div>
<div class="sect2">
<h3 id="creating-the-connection-pool"><a class="anchor" href="#creating-the-connection-pool"></a>Creating a connection pool</h3>
<div class="paragraph">
<p>It is possible to create a JDBC connection pool on the web administration console, or using administration commands.</p>
</div>
<div class="sect3">
<h4 id="using-admin-console"><a class="anchor" href="#using-admin-console"></a>Using Admin Console</h4>
<div class="paragraph">
<p>In the left hand panel of the Admin console go to <em>Resources</em> &#8594; <em>JDBC</em> &#8594; <em>JDBC Connection Pools</em></p>
</div>
<div class="paragraph">
<p>Click the <em>New</em> button and enter the following values:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Setting Name</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pool Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">test-pool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">javax.sql.DataSource</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Driver Vendor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(value for the driver, e.g. Derby30 for a Derby DB, MySQL for a MySQL DB)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Click Next and then click Finish on the next screen, accepting the default values.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/connection-pools/connection_pools_1.png" alt="New JDBC Connection Pool"></span></p>
</div>
<div class="paragraph">
<p>Add the following properties to the connection pool by going to the <em>Additional Properties</em> tab of the connection pool:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Setting name</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PortNumber</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3306</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mypassword</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database password</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">root</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database user</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">serverName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">localhost</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database address</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DatabaseName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the database</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">connectionAttributes</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Other connection attributes (supported by the JDBC driver)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/connection-pools/connection_pools_2.png" alt="Connection pool properties"></span></p>
</div>
<div class="paragraph">
<p>To test the connection attributes, go back to the <em>General</em> tab and click the <em>Ping</em> button at the top of the screen. You should see a message stating that the ping succeeded.</p>
</div>
</div>
<div class="sect3">
<h4 id="using-asadmin"><a class="anchor" href="#using-asadmin"></a>Using administration commands</h4>
<div class="paragraph">
<p>You can also create a JDBC connection pool using the <code>asadmin</code> command line tool with the following options:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin&gt; create-jdbc-connection-pool --datasourceclassname com.mysql.jdbc.jdbc2.optional.MysqlDataSource --restype javax.sql.DataSource --property user=root:password=test:DatabaseName=test:ServerName=localhost:port=3306 test-pool</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this command, you need to specify the full name of the driver&#8217;s class instead of just selecting a value from a drop-down menu.</p>
</div>
<div class="paragraph">
<p>You can test the connection to the database from the command line run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin&gt; ping-connection-pool test-pool</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jdbc-call-logging-sql-tracing"><a class="anchor" href="#jdbc-call-logging-sql-tracing"></a>JDBC Call Logging (SQL Tracing)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>:page-aliases:Technical Documentation/Payara Server Documentation/advanced-jdbc/log-jdbc-calls.adoc</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This is a feature best used for development purposes due to the volume of trace data that is produced.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>SQL calls made through a JDBC connection pool can be traced, with the time taken to execute the call also recorded. SQL Tracing is ideal for debugging those hard to pin down performance issues during the development phase and as all SQL is visible SQL tracing is also a great way to see the SQL generated out of your JPA code.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="enabling-jdbc-call-logging"><a class="anchor" href="#enabling-jdbc-call-logging"></a>Enabling JDBC Call Logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With <strong>Log JDBC Calls</strong> configured on the connection call each call into the connection pool is timed and logged to the server log at the <code>FINE</code> level. A typical log message with Log JDBC Enabled is shown below;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-log hljs" data-lang="log">[#|2016-02-04T18:51:01.467+0000|FINE|Payara 5.2021.5|javax.enterprise.resource.sqltrace.com.sun.gjc.util|_ThreadID=35;_ThreadName=http-listener-1(5);_TimeMillis=1454611861467;_LevelValue=500;ClassName=com.sun.gjc.util.SQLTraceLogger;MethodName=sqlTrace;|
  PoolName=H2Pool | ExecutionTime=1ms | ClassName=org.apache.derby.client.net.NetConnection40 | MethodName=prepareStatement | arg[0]=SELECT ID, AGE, BIO, BIRTHDATE, BIRTHDAY, DATEFORMAT, DATEOFBIRTH, DATEOFHIRE, EMAIL, HIREDATE, HIREDAY, MEMBERAGE, NAME, TODAYSDATE FROM MEMBERENTITY WHERE (NAME = ?) | arg[1]=1003 | arg[2]=1007 | |#]</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="jdbc-call-logging-administration-console"><a class="anchor" href="#jdbc-call-logging-administration-console"></a>Using the Administration Console</h3>
<div class="paragraph">
<p>SQL Tracing can be enabled through the Payara Server Web administration console. First, navigate to the advanced table of your JDBC connection pool, then select the <em>JDBC &gt; JDBC Connection pools &gt; ${Your Connection pool}</em>.</p>
</div>
<div class="paragraph">
<p>Then select the <strong>Advanced Tab</strong> in the main window of the administration console. Then select the checkbox next to <strong>Log JDBC Calls</strong> to enable logging of all SQL calls:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/advanced-jdbc/logjdbccall.png" alt="Enabling SQL Tracing in the administration console"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="asadmin-command-line-interface"><a class="anchor" href="#asadmin-command-line-interface"></a>Using Asadmin Commands</h3>
<div class="paragraph">
<p>The <strong>Log JDBC Calls</strong> setting for a JDBC connection pool can also be configured via asadmin using the <code>set</code> command to set the <code>fish.payara.log-jdbc-calls</code> property of your connection pool to <code>true</code>, like in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin set domain.resources.jdbc-connection-pool.__TimerPool.log-jdbc-calls=true</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jdbc-call-logging-deployment"><a class="anchor" href="#jdbc-call-logging-deployment"></a>Application Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Java EE 7+ applications and above, a JDBC data source can be deployed by adding the <code>@DataSourceDefinition</code> annotation to  a managed component (like and <code>@Stateless</code> EJB bean for example). The <strong>Log JDBC Calls</strong> setting can be configured using this annotation as well:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@DataSourceDefinition(
    name = "java:app/MyApp/MyDS",
    className = "org.h2.jdbcx.JdbcDataSource",
    url = "jdbc:h2:mem:test",
    properties = {"fish.payara.log-jdbc-calls=true"})</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Data source definition can also be added to a deployment descriptor of an application, for example in the <em>web.xml</em> standard deployment descriptor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;data-source&gt;
   &lt;name&gt;java:global/ExampleDataSource&lt;/name&gt;
   &lt;class-name&gt;com.mysql.jdbc.jdbc2.optional.MysqlXADataSource&lt;/class-name&gt;
   &lt;server-name&gt;localhost&lt;/server-name&gt;
   &lt;port-number&gt;3306&lt;/port-number&gt;
   &lt;database-name&gt;mysql&lt;/database-name&gt;
   &lt;user&gt;test&lt;/user&gt;
   &lt;password&gt;test&lt;/password&gt;
   &lt;!-- Example of how to use a Payara specific custom connection pool setting --&gt;
   &lt;property&gt;
       &lt;name&gt;fish.payara.log-jdbc-calls&lt;/name&gt;
       &lt;value&gt;true&lt;/value&gt;
   &lt;/property&gt;
&lt;/data-source&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or in the definition of a <code>jdbc-connection-pool</code> in a <em>payara-resources.xml</em> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;jdbc-connection-pool name="examplePool"
        res-type="javax.sql.DataSource"
        datasource-classname="org.h2.jdbcx.JdbcDataSource" log-jdbc-calls="true"&gt;
    &lt;property name="user" value="test"/&gt;
    &lt;property name="password" value="test"/&gt;
    &lt;property name="url" value="java:global/ExampleDataSource"/&gt;
&lt;/jdbc-connection-pool&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This can also be done in the creation of a JDBC Connection Pool with the <code>--logjdbccalls</code> option.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin create jdbc-connection-pool --datasourceclassname org.h2.jdbcx.JdbcDataSource --restype javax.sql.XADataSource --logjdbccalls=true examplePool</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="advance-connection-pool-properties-in-deployment-descriptors"><a class="anchor" href="#advance-connection-pool-properties-in-deployment-descriptors"></a>Advanced Connection Pool Properties in Deployment Descriptors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>:page-aliases:Technical Documentation/Payara Server Documentation/advanced-jdbc/advanced-connection-pool-properties.adoc</p>
</div>
<div class="paragraph">
<p>Payara Server supports setting advanced JDBC connection pool properties directly on data source definitions made with the <code>@DataSourceDefinition</code> annotation or directly on deployment descriptors.</p>
</div>
<div class="sect2">
<h3 id="setting-properties-in-the-deployment-descriptor"><a class="anchor" href="#setting-properties-in-the-deployment-descriptor"></a>Setting Properties in the Deployment Descriptor</h3>
<div class="paragraph">
<p>In a Java EE 7+ application, a data source definition can be added to a deployment descriptor of an application. For a web application, you would this in the standard <em>web.xml</em> deployment descriptor. To set advanced properties just add a <code>property</code> element as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;data-source&gt;
    &lt;name&gt;java:global/ExampleDataSource&lt;/name&gt;
    &lt;class-name&gt;com.mysql.jdbc.jdbc2.optional.MysqlXADataSource&lt;/class-name&gt;
    &lt;server-name&gt;localhost&lt;/server-name&gt;
    &lt;port-number&gt;3306&lt;/port-number&gt;
    &lt;database-name&gt;mysql&lt;/database-name&gt;
    &lt;user&gt;test&lt;/user&gt;
    &lt;password&gt;test&lt;/password&gt;
    &lt;!-- Example of how to use a Payara specific custom connection pool setting --&gt;
    &lt;property&gt;
       &lt;name&gt;fish.payara.is-connection-validation-required&lt;/name&gt;
       &lt;value&gt;true&lt;/value&gt;
    &lt;/property&gt;
&lt;/data-source&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="setting-properties-via-annotations."><a class="anchor" href="#setting-properties-via-annotations."></a>Setting Properties on the <code>@DataSourceDefinition</code> Annotation.</h3>
<div class="paragraph">
<p>In Java EE 7+ applications, a JDBC data source can be deployed by adding the <code>@DataSourceDefinition</code> annotation to  a managed component (like and <code>@Stateless</code> EJB bean for example). To configure advanced JDBC properties, use the <code>properties</code> attribute of the annotation to define an array of the properties to configure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@DataSourceDefinition(
    name = "java:app/MyApp/MyDS",
    className = "org.h2.jdbcx.JdbcDataSource",
    url = "jdbc:h2:mem:test",
    properties = {"fish.payara.is-connection-validation-required=true"})</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="full-list-of-properties"><a class="anchor" href="#full-list-of-properties"></a>Full List of Properties</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The complete list of configurable properties is the following:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Value Type</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.is-connection-validation-required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true -
Validate connections, allow server to reconnect in case of failure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.connection-validation-method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The method of connection validation table,
autocommit, meta-data, custom-validation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.validation-table-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the table used for validation if the validation method is
set to table</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.validation-classname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the custom class used for validation if the
validation-method is set to custom-validation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.fail-all-connections</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Close all connections
and reconnect on failure, otherwise reconnect only when used</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.allow-non-component-callers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable the
pool to be used by non-component callers such as Servlet Filters</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.validate-atmost-once-period-in-seconds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the time interval in seconds between successive requests to
validate a connection at most once. Default value is 0, which means the
attribute is not enabled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.connection-leak-timeout-in-seconds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 implies no
connection leak detection</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.connection-leak-reclaim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If enabled, leaked
connection will be reclaimed by the pool after connection leak timeout
occurs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.connection-creation-retry-attempts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of
attempts to create a new connection. 0 implies no retries</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.connection-creation-retry-interval-in-seconds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time interval between retries while attempting to create a connection.
Effective when Creation Retry Attempts is greater than 0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.statement-timeout-in-seconds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timeout property
of a connection to enable termination of abnormally long running
queries. -1 implies that it is not enabled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.lazy-connection-enlistment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enlist a
resource to the transaction only when it is actually used in a method</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.lazy-connection-association</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connections
are lazily associated when an operation is performed on them</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.associate-with-thread</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When the same thread
is in need of a connection, it can reuse the connection already
associated with that thread</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.pooling</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When set to false, disables
connection pooling for the pool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.statement-cache-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Caching is enabled when
set to a positive non-zero value (for example, 10)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.match-connections</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Turns connection matching
for the pool on or off</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.max-connection-usage-count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connections will be
reused by the pool for the specified number of times, after which they
will be closed. 0 implies the feature is not enabled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.wrap-jdbc-objects</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When set to true,
application will get wrapped jdbc objects for Statement,
PreparedStatement, CallableStatement, ResultSet, DatabaseMetaData</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.sql-trace-listeners</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-separated list of classes that implement the
org.glassfish.api.jdbc.SQLTraceListener interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.ping</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When enabled, the pool is pinged
during creation or reconfiguration to identify and warn of any erroneous
values for its attributes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.init-sql</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify a SQL
string to be executed whenever a connection is created from the pool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.statement-leak-timeout-in-seconds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 implies no
statement leak detection</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.statement-leak-reclaim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If enabled, leaked
statement will be reclaimed by the pool after statement leak timeout
occurs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.statement-cache-type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.slow-query-threshold-in-seconds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL queries
that exceed this time in seconds will be logged. Any value &#8656; 0 disables
Slow Query Logging</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fish.payara.log-jdbc-calls</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When set to true, all JDBC
calls will be logged allowing tracing of all JDBC interactions including
SQL</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="example-datasource-configuration"><a class="anchor" href="#example-datasource-configuration"></a>Example Data Source Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An example data source configured on the <em>web.xml</em> and deployed with a custom <strong>SQL Trace Listener</strong> is shown below. This data source is configured to also validate all connections returned from the connection pool before giving them to the application using the built-in <em>MySQL</em> <strong>Connection Validation</strong> class. The data source is also configured to log any queries that exceed <strong>5</strong> seconds and also logs ALL JDBC statements:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"
     version="3.1"&gt;
    &lt;session-config&gt;
        &lt;session-timeout&gt;30&lt;/session-timeout&gt;
    &lt;/session-config&gt;
    &lt;data-source&gt;
      &lt;name&gt;java:global/ExampleDataSource&lt;/name&gt;
      &lt;class-name&gt;com.mysql.jdbc.jdbc2.optional.MysqlXADataSource&lt;/class-name&gt;
      &lt;server-name&gt;localhost&lt;/server-name&gt;
      &lt;port-number&gt;3306&lt;/port-number&gt;
      &lt;database-name&gt;mysql&lt;/database-name&gt;
      &lt;user&gt;test&lt;/user&gt;
      &lt;password&gt;test&lt;/password&gt;
      &lt;!-- Example of how to use a Payara specific custom connection pool setting --&gt;
      &lt;property&gt;
          &lt;name&gt;fish.payara.slow-query-threshold-in-seconds&lt;/name&gt;
          &lt;value&gt;5&lt;/value&gt;
      &lt;/property&gt;
      &lt;property&gt;
          &lt;name&gt;fish.payara.log-jdbc-calls&lt;/name&gt;
          &lt;value&gt;true&lt;/value&gt;
      &lt;/property&gt;
      &lt;property&gt;
          &lt;name&gt;fish.payara.sql-trace-listeners &lt;/name&gt;
          &lt;value&gt;fish.payara.examples.payaramicro.datasource.example.CustomSQLTracer&lt;/value&gt;
      &lt;/property&gt;
      &lt;property&gt;
          &lt;name&gt;fish.payara.is-connection-validation-required&lt;/name&gt;
          &lt;value&gt;true&lt;/value&gt;
      &lt;/property&gt;
      &lt;property&gt;
          &lt;name&gt;fish.payara.connection-validation-method&lt;/name&gt;
          &lt;value&gt;custom-validation&lt;/value&gt;
      &lt;/property&gt;
      &lt;property&gt;
          &lt;name&gt;fish.payara.validation-classname&lt;/name&gt;
          &lt;value&gt;org.glassfish.api.jdbc.validation.MySQLConnectionValidation&lt;/value&gt;
      &lt;/property&gt;
    &lt;/data-source&gt;
&lt;/web-app&gt;</code></pre>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../../../_/js/site.js"></script>
<script async src="../../../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../../../_/js/vendor/docSearch.js"></script>
  </body>
</html>
