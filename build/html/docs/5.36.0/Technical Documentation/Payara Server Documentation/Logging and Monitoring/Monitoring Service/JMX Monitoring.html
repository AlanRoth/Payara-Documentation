<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JMX Monitoring :: Payara Documentation Preview</title>
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../../../../../../_/css/site.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@alpha" />
    <meta name="docsearch:version" content="5.36.0" />
  </head>
  <body class="article">
  <header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../../../..">Payara Documentation Preview</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-item hide-for-print">
        Version: <div class="page-versions">
  <button class="version-menu-toggle single-version" title="Current version">5.36.0</button>
</div>

      </div>
      <div class="navbar-item hide-for-print">
            <div id="search-input-container">
    </div>
      </div>

      <div class="navbar-end">
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://www.payara.fish/products/downloads/">Download</a>
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary enterprise" href="../../../../../../../enterprise">Documentation for Payara Enterprise</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="5.36.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">docs</span>
    <span class="version">5.36.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../../index.html">5.36.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../Overview.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../../index.html">docs</a></li>
    <li><a href="JMX%20Monitoring.html">JMX Monitoring</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/alanroth/Workspace/Payara-Documentation/docs/modules/ROOT/pages/Technical%20Documentation/Payara%20Server%20Documentation/Logging%20and%20Monitoring/Monitoring%20Service/JMX%20Monitoring.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">JMX Monitoring</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Payara offers a custom JMX Monitoring Service. Once configured, Payara
Server Community will monitor and log the values of attributes that have been listed
for monitoring. The metrics are logged together in a single log message as
a series of key-value pairs prefixed by the string <code>JMX-MONITORING:</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="enable-jmx"><a class="anchor" href="#enable-jmx"></a>Enabling JMX Monitoring</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Payara uses the AMX API for working with <em>JMX MBeans</em>. AMX is not fully
exposed by default and as such needs to be loaded to access most <em>JMX MBean</em>
objects. The JMX Monitoring Service can be used without AMX but
there is a limit to what can be monitored without it.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="boot-amx"><a class="anchor" href="#boot-amx"></a>Boot AMX</h3>
<div class="paragraph">
<p>To boot AMX at startup or independently from the JMX Monitoring service, run the
command below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin&gt;set-amx-enabled --enabled true --dynamic true --target server</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-web-admin-console"><a class="anchor" href="#using-web-admin-console"></a>Boot AMX Using the Admin Console</h3>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/jmx-monitoring-service/enable_amx.png" alt="Enable AMX"></span></p>
</div>
<div class="paragraph">
<p>You can now enable JMX Monitoring using the <code>set-jmx-monitoring-configuration</code> asadmin command</p>
</div>
<div class="paragraph">
<p>JMX Monitoring can either be enabled for next startup or the service can be dynamically
enabled on a running instance of Payara (provided a non-empty configuration exists
at server startup). To enable the service dynamically on the default running
instance of Payara the command to run is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin&gt; set-jmx-monitoring-configuration --dynamic true --enabled true</code></pre>
</div>
</div>
<div class="paragraph">
<p>To enable the service for next startup the <code>--dynamic</code> option would need
to be dropped from the command.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="get-jmx-config"><a class="anchor" href="#get-jmx-config"></a>Getting The JMX Monitoring Configuration</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>Usage</strong></dt>
<dd>
<p><code>asadmin&gt; get-jmx-monitoring-configuration --pretty false|true</code></p>
</dd>
<dt class="hdlist1"><strong>Aim</strong></dt>
<dd>
<p>Retrieves the monitoring service configuration and outputs it.</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="command-options-2"><a class="anchor" href="#command-options-2"></a>Command Options</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Mandatory</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--target</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the configuration to get the monitoring service configuration from.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--pretty</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Displays Boolean configuration options as a tick
or cross</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>N/A</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configure-jmx"><a class="anchor" href="#configure-jmx"></a>Setting The JMX Monitoring Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can configure JMX Monitoring using the <code>set-jmx-monitoring-configuration</code> asadmin command.</p>
</div>
<div class="sect2">
<h3 id="adding-the-monitoring-attribute"><a class="anchor" href="#adding-the-monitoring-attribute"></a>Adding a monitoring attribute</h3>
<div class="paragraph">
<p>To add the <code>HeapMemoryUsage</code> attribute to the list of MBean attributes to monitor
using the service the following command can be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin&gt; set-jmx-monitoring-configuration --addattribute 'attributeName=HeapMemoryUsage
objectName=java.lang:type=Memory' --enabled false</code></pre>
</div>
</div>
<div class="paragraph">
<p>Breaking this command down, two arguments have been used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>--addattribute</code></p>
</li>
<li>
<p><code>--enabled</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Passing <code>--addattribute</code> to <code>set-jmx-monitoring-configuration</code> provides a way to
add a new <strong>MBean</strong> attribute to monitor using the service. This argument takes
in a string of space-delimited key-value pairs corresponding to the values listed
earlier. The <code>attributeName</code> and <code>objectName</code> fields are required, but <code>description</code>
is not. Providing <code>attributeName=HeapMemoryUsage</code> denotes that the name of the
<strong>MBean</strong> attribute to log is <code>HeapMemoryUsage</code>, while <code>objectName=java.lang:type=Memory</code>
denotes the <code>ObjectName</code> of the <strong>MBean</strong> to look for the attribute on is <code>java.lang:type=Memory</code>.</p>
</div>
<div class="paragraph">
<p>The second argument, <code>--enabled</code>, is the only required option for the <code>asadmin</code>
command. The only valid values to give this option are <code>true</code> or <code>false</code>. Passing
<code>false</code> to the option will disable the logging service on next startup if it is
currently enabled, but will otherwise do nothing. Under this scenario the monitoring
service has not been configured yet so <code>false</code> was passed.</p>
</div>
</div>
<div class="sect2">
<h3 id="dealing-with-composite-mbean-attributes"><a class="anchor" href="#dealing-with-composite-mbean-attributes"></a>Dealing with composite MBean attributes</h3>
<div class="paragraph">
<p>The <strong>MBean</strong> attribute added, <code>HeapMemoryUsage</code>, is a composite attribute.</p>
</div>
<div class="paragraph">
<p>It has metrics for the <code>commited</code>, <code>init</code>, <code>max</code> and <code>used</code> attributes. The
monitoring service will by default monitor each metric and log it as
<code>{$metric}{$attribute_name}:{$attribute_value}</code>.</p>
</div>
<div class="paragraph">
<p>If this is not the desired result, it is possible to monitor a single metric for
 a composite <strong>MBean</strong> attribute. To monitor a single metric for the attribute
the value of <code>attributeName</code> passed to the <code>--addattribute</code> option should be modified like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>attributeName=HeapMemoryUsage.metric</pre>
</div>
</div>
<div class="paragraph">
<p>So to log only the used heap memory the asadmin command would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin&gt; set-jmx-monitoring-configuration --addattribute 'attributeName=HeapMemoryUsage.used
objectName=java.lang:type=Memory' --enabled false</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="setting-logging-frequency"><a class="anchor" href="#setting-logging-frequency"></a>Setting logging frequency</h3>
<div class="paragraph">
<p>There are two configuration attributes related to the frequency at which log
messages are written: <code>logfrequency</code> and <code>logfrequencyunit</code>. The first is a
numerical value used for the rate, while the second is the unit for the rate.
The default configuration is set to have a message logged every <em>15 seconds</em>.</p>
</div>
<div class="paragraph">
<p>If the value of <code>logfrequencyunit</code> is the default of <code>SECONDS</code> then to
have the monitoring service log messages every one minute execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin&gt; set-jmx-monitoring-configuration --logfrequency 60 --enabled false</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="see-also"><a class="anchor" href="#see-also"></a>See Also</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="../Notification%20Service/JMX%20Monitoring%20Notifications/JMX%20Monitoring%20Notifiers%20Configuration.html" class="page">Configuring Notification for JMX Monitoring</a></p>
</li>
</ul>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../../../_/js/site.js"></script>
<script async src="../../../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../../../_/js/vendor/docSearch.js"></script>
  </body>
</html>
