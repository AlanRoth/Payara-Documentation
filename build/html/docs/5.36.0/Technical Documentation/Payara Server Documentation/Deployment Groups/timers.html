<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Timers in Deployment Groups :: Payara Documentation Preview</title>
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../../../../../_/css/site.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@alpha" />
    <meta name="docsearch:version" content="5.36.0" />
  </head>
  <body class="article">
  <header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../../..">Payara Documentation Preview</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-item hide-for-print">
        Version: <div class="page-versions">
  <button class="version-menu-toggle single-version" title="Current version">5.36.0</button>
</div>

      </div>
      <div class="navbar-item hide-for-print">
            <div id="search-input-container">
    </div>
      </div>

      <div class="navbar-end">
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://www.payara.fish/products/downloads/">Download</a>
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary enterprise" href="../../../../../../enterprise">Documentation for Payara Enterprise</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="5.36.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">docs</span>
    <span class="version">5.36.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../index.html">5.36.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../Overview.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../index.html">docs</a></li>
    <li><a href="timers.html">Timers in Deployment Groups</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/alanroth/Workspace/Payara-Documentation/docs/modules/ROOT/pages/Technical%20Documentation/Payara%20Server%20Documentation/Deployment%20Groups/timers.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Timers in Deployment Groups</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Timer facilities provided by EJB APIs <code>TimerService</code> and <code>@Scheduled</code> need special configuration in order to work intuitively for applications deployed to a deployment group.</p>
</div>
<div class="paragraph">
<p>There are four types of timers distinguished by their lifecycle (persistent, non-persistent) and the mean of their definition (declarative, programmatic).</p>
</div>
<div class="paragraph">
<p>Declarative timers are defined in EJB deployment descriptors or with annotation <code>@Scheduled</code>.
Programmatic timers are created via calls to <code>TimerService.create*Timer</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_non_persistent_timers"><a class="anchor" href="#_non_persistent_timers"></a>Non-Persistent Timers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Non-Persistent timers exist in memory only for the duration in which the application runs on the instance.
Declarative non-persistent timers run on every instance, whereas programmatic ones only on the instance that created them.
When the instance shuts down, the timer stops firing.
Instances do not see each other&#8217;s non-persistent timers, so calling <code>TimerService.getTimers()</code> only returns local non-persistent timers.</p>
</div>
<div class="paragraph">
<p>Non-Persistent timers have a simpler lifecycle but are not the default option
To make a timer non-persistent, the <code>@Schedule</code> annotation needs the attribute <code>persistent=false</code>, or the <code>TimerConfig</code> objects need to have their property <code>persistent</code> set to <code>false</code> explicitly.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_persistent_timers"><a class="anchor" href="#_persistent_timers"></a>Persistent Timers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Persistent timers exist in the persistent store for the entire time for which application is deployed to a domain.
Contrary to non-persistent ones, each persistent timer is only executed on a single instance of a deployment group.
When the instance shuts down, each persistent timer migrates to another instance in the application&#8217;s deployment group and continues firing there.
Since persistent timers are shared, <code>TimerService.getTimers()</code> returns all persistent timers in the deployment group, regardless of which instance created them.</p>
</div>
<div class="paragraph">
<p>Persistent timers are the default kind of timer.</p>
</div>
<div class="sect2">
<h3 id="_preconditions_for_using_persistent_timers_in_deployment_groups"><a class="anchor" href="#_preconditions_for_using_persistent_timers_in_deployment_groups"></a>Preconditions for using Persistent Timers in Deployment Groups</h3>
<div class="paragraph">
<p>Because deployment groups do not need to share configurations amongst instances, there are several confiration and operational constraints that are not enforced by the server.
To ensure correct behaviour of persistent timers within a deployment group, the following conditions need to be met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>EJB Timer Service needs to use shared storage&#8201;&#8212;&#8201;external database or <a href="#../ejb/persistent-timers.adoc" class="page unresolved">DataGrid</a></p>
</li>
<li>
<p>All instances of deployment groups and the Domain Administration Server share the same configuration of EJB Timer Service</p>
</li>
<li>
<p>Applications with persistent timers are deployed to a deployment group and not managed on instance level afterwards</p>
</li>
<li>
<p>Instances are members of only a single deployment group</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../../_/js/site.js"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../../_/js/vendor/docSearch.js"></script>
  </body>
</html>
