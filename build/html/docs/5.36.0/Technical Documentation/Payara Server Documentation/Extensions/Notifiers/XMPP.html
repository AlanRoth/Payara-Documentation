<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>XMPP Notifier :: Payara Documentation Preview</title>
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../../../../../../_/css/site.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@alpha" />
    <meta name="docsearch:version" content="5.36.0" />
  </head>
  <body class="article">
  <header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../../../..">Payara Documentation Preview</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-item hide-for-print">
        Version: <div class="page-versions">
  <button class="version-menu-toggle single-version" title="Current version">5.36.0</button>
</div>

      </div>
      <div class="navbar-item hide-for-print">
            <div id="search-input-container">
    </div>
      </div>

      <div class="navbar-end">
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://www.payara.fish/products/downloads/">Download</a>
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary enterprise" href="../../../../../../../enterprise">Documentation for Payara Enterprise</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="5.36.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">docs</span>
    <span class="version">5.36.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../../index.html">5.36.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../Overview.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../../index.html">docs</a></li>
    <li><a href="XMPP.html">XMPP Notifier</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/alanroth/Workspace/ondro-poc/docs/modules/ROOT/pages/Technical%20Documentation/Payara%20Server%20Documentation/Extensions/Notifiers/XMPP.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">XMPP Notifier</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The E<strong>X</strong>tensible <strong>M</strong>essaging and <strong>P</strong>resence <strong>P</strong>rotocol is a communication protocol based on <strong>XML</strong> notation, focused through the exchange of structured messages across services and devices on multiple network arrangements and targeted towards Message Oriented Middleware.</p>
</div>
<div class="paragraph">
<p>Formerly known as <strong>Jabber</strong>, XMPP is an open standard, which means that anyone can implement toolsets used to send and receive messages across its implementations.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="downloads"><a class="anchor" href="#downloads"></a>Downloads</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://nexus.payara.fish/repository/payara-artifacts/fish/payara/extensions/notifiers/xmpp-notifier-core/1.0/xmpp-notifier-core-1.0.jar">XMPP Notifier Core 1.0</a></p>
</li>
<li>
<p><a href="https://nexus.payara.fish/repository/payara-artifacts/fish/payara/extensions/notifiers/xmpp-notifier-console-plugin/1.0/xmpp-notifier-console-plugin-1.0.jar">XMPP Notifier Console Plugin 1.0</a></p>
</li>
<li>
<p><a href="https://repo1.maven.org/maven2/org/igniterealtime/smack/smack-java7/4.1.9/smack-java7-4.1.9.jar">Dependency: smack-java7 4.1.9</a></p>
</li>
<li>
<p><a href="https://repo1.maven.org/maven2/org/igniterealtime/smack/smack-tcp/4.1.9/smack-tcp-4.1.9.jar">Dependency: smack-tcp 4.1.9</a></p>
</li>
<li>
<p><a href="https://repo1.maven.org/maven2/org/igniterealtime/smack/smack-extensions/4.1.9/smack-extensions-4.1.9.jar">Dependency: smack-extensions 4.1.9</a></p>
</li>
<li>
<p><a href="https://repo1.maven.org/maven2/org/igniterealtime/smack/smack-im/4.1.9/smack-im-4.1.9.jar">Dependency: smack-im 4.1.9</a></p>
</li>
<li>
<p><a href="https://repo1.maven.org/maven2/org/apache/servicemix/bundles/org.apache.servicemix.bundles.xpp3/1.1.4c_7/org.apache.servicemix.bundles.xpp3-1.1.4c_7.jar">Dependency: XPP3 1.1.4c_7</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="xmpp-server-configuration"><a class="anchor" href="#xmpp-server-configuration"></a>XMPP Server Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>XMPP works using a <em>client-server</em> architecture, akin to other messaging solutions like Hipchat, Slack or IRC for example. Unlike those, XMPP is <strong>decentralized</strong>, which means that any person or organization can run its own server using a proprietary domain (which can be public or private depending of the user needs). There are multiple server implementations in the market, with both open source and commercial licensing models like the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://mina.apache.org/vysper-project">Apache Vysper</a> (Open Source)</p>
</li>
<li>
<p><a href="https://www.oracle.com/industries/communications/enterprise/products/instant-messaging/index.html">Oracle
Communications Instant Messaging Server</a> (Commercial)</p>
</li>
<li>
<p><a href="http://igniterealtime.org/projects/openfire/index.jsp">OpenFire</a> (Open
Source)</p>
</li>
<li>
<p><a href="https://www.communigate.com/default.html">CommuniGate Pro</a> (Commercial)</p>
</li>
<li>
<p><a href="http://jabberd2.org/">Jabberd 2</a> (Open Source)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>No matter what XMPP server you or your organization is using, the Notifier Service will be able to communicate with it and push notifications to a specific chat room hosted on the server.</p>
</div>
<div class="sect2">
<h3 id="requirements"><a class="anchor" href="#requirements"></a>Requirements</h3>
<div class="paragraph">
<p>The following are the requirements needed to be fulfilled by the XMPP server:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure the XMPP server with a valid domain name/FQDN</p>
</li>
<li>
<p>If considering secure communication, the XMPP server must have a valid SSL certificate configured for its FQDN</p>
</li>
<li>
<p>Configure the service for text-based conferencing (this service is usually named <strong>conference</strong> and is a subdomain of the server)</p>
</li>
<li>
<p>Create room that will be used to receive the notifications sent by Payara Server.</p>
</li>
<li>
<p>Create a user that is allowed to access the room created and push notification messages.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>As an example, we will use <em>OpenFire</em> to illustrate how to correctly configure these requirements and the notifier. If you are using a different server, check its documentation and follow its instructions based on what&#8217;s being done here.</p>
</div>
</div>
<div class="sect2">
<h3 id="openfire-configuration"><a class="anchor" href="#openfire-configuration"></a>OpenFire Configuration</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Proceed to download and install the OpenFire server by following the instructions detailed
<a href="http://download.igniterealtime.org/openfire/docs/latest/documentation/install-guide.html">here</a>.
Once the server is installed, start the OpenFire service and head to the server&#8217;s admin console located at <code><a href="http://{FQDN}:9090/" class="bare">http://{FQDN}:9090/</a></code></p>
</li>
<li>
<p>Since the server was recently installed it will prepare a bootstrapping wizard. First, select the language that will be used by the administration interface:</p>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/notification-service/xmpp/openfire-install-1.png" alt="OpenFire Language Select Screen"></span></p>
</div>
</li>
<li>
<p>Now, proceed to configure the domain name and <em>FQDN</em> of your server. You can also alter the ports for the admin console and configure secure access using property encryption if necessary:</p>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/notification-service/xmpp/openfire-install-2.png" alt="OpenFire Server Settings Screen"></span></p>
</div>
</li>
<li>
<p>To use OpenFire on production environments, its recommended to install an external database used to store its configuration and data. For the sake of simplicity, we will use the embedded option instead:</p>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/notification-service/xmpp/openfire-install-3.png" alt="OpenFire Database Select Screen"></span></p>
</div>
</li>
<li>
<p>Next, we have to configure the user data store that will back the server&#8217;s authentication. Generally speaking, is not uncommon that an organization uses a <strong>LDAP</strong> directory to store profiles so that option is recommended on production environments. As with the previous configuration we will use the simpler option:</p>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/notification-service/xmpp/openfire-install-4.png" alt="OpenFire Profile Screen"></span></p>
</div>
</li>
<li>
<p>Finally, configure the credentials for the <strong>admin</strong> user:</p>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/notification-service/xmpp/openfire-install-5.png" alt="OpenFire Admin User Screen"></span></p>
</div>
</li>
<li>
<p>With the server installation complete, login to the admin console with the credentials of the administrator user:</p>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/notification-service/xmpp/openfire-login.png" alt="OpenFire Login"></span></p>
</div>
</li>
<li>
<p>Now we need to create the user that will be used to push notifications on the service&#8217;s room. Select the <strong>User/Groups</strong> option in the top menu:</p>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/notification-service/xmpp/openfire-users-1.png" alt="OpenFire User Summary"></span></p>
</div>
</li>
<li>
<p>Click on the <strong>Create New User</strong> option in the sidebar. Input the information for this new user (<strong>Username</strong>, <strong>Name</strong> and <strong>Password</strong> are required):</p>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/notification-service/xmpp/openfire-users-2.png" alt="OpenFire New User"></span></p>
</div>
</li>
<li>
<p>With the user created, we will proceed to create the room used to display notifications. Select the <strong>Group Chat</strong> option in the top menu:</p>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/notification-service/xmpp/openfire-create-room-1.png" alt="OpenFire Room Summary"></span></p>
</div>
</li>
<li>
<p>Now, click on the <strong>Create New Room</strong> option in the sidebar. Be sure to input the room&#8217;s <strong>ID</strong>, <strong>Name</strong> and <strong>Description</strong> as requested:</p>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/notification-service/xmpp/openfire-create-room-2.png" alt="OpenFire New Room"></span></p>
</div>
</li>
<li>
<p>Check that the room was created successfully. Click on the room&#8217;s link to enter its details. Take special note of the <strong>Service Name</strong>, which will be used to configure the notifier later:</p>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/notification-service/xmpp/openfire-room-details.png" alt="OpenFire Room Details"></span></p>
</div>
</li>
<li>
<p>Finally, select the <strong>Permissions</strong> option in the sidebar and add the user we created earlier in the <strong>Room Occupants</strong> section. You can do this by searching using its username in the search box:</p>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/notification-service/xmpp/openfire-room-permissions.png" alt="OpenFire Room Permissions"></span></p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>With this, the XMPP server configuration is completed.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="payara-server-configuration"><a class="anchor" href="#payara-server-configuration"></a>Payara Server Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With the XMPP server properly configured, now it&#8217;s time to setup the <em>Notification Service</em> in the domain&#8217;s configuration.</p>
</div>
<div class="paragraph">
<p>The configuration settings required by the service are the following:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Server&#8217;s Location</dt>
<dd>
<p><em>Hostname</em> and <em>Port</em> where the XMPP is listening for requests. The hostname is required, the port defaults to <em>*5222*</em> if not provided.</p>
</dd>
<dt class="hdlist1">Service Name</dt>
<dd>
<p>Used by the XMPP server to manage group chat sessions, always required.</p>
</dd>
<dt class="hdlist1">Room ID</dt>
<dd>
<p>The ID of the room that will be used to host the notification events, always required.</p>
</dd>
<dt class="hdlist1">Credentials</dt>
<dd>
<p>The <em>Username</em> and <em>Password</em> of the user that will post notification events in the room.</p>
</dd>
</dl>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can also configure an option whether or not to disable security transport (SSL) when establishing communication to the server. The default value for this setting is <code>false</code>. It&#8217;s not recommended to disable secure access on production environments, so use it with discretion.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="using-the-admin-console"><a class="anchor" href="#using-the-admin-console"></a>Using the Administration Web Console</h3>
<div class="paragraph">
<p>To configure the Notification Service in the Administration Console, go to <em>Configuration &#8594; [instance-configuration (like server-config)] &#8594; Notification Service</em> and click on the <strong>XMPP</strong> tab:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/notification-service/xmpp/admin-console-configuration.png" alt="XMPP Notifier in Admin Console"></span></p>
</div>
<div class="paragraph">
<p>Check the <strong>Enabled</strong> box (and the <strong>Dynamic</strong> box too if you don&#8217;t want to restart the domain) and input the required information. Hit the <strong>Save</strong> button to preserve the changes.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-the-asadmin-cli"><a class="anchor" href="#using-the-asadmin-cli"></a>Using the Asadmin CLI</h3>
<div class="paragraph">
<p>To configure the Notification Service from the command line, use the <code>set-xmpp-notifier-configuration</code> asadmin command, specifying the configuration options like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin&gt; set-xmpp-notifier-configuration --enabled=true --dynamic=true --hostname="172.28.128.3" --xmppport=5222 --username="payara_notifier" --password="******" --securityDisabled=false --roomid=server</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>--enabled</code> and <code>--dynamic</code> options to enable or disable the XMPP notifier on demand.</p>
</div>
<div class="paragraph">
<p>Also, you can retrieve the current configuration for the XMPP notifier using the <code>get-xmpp-notifier-configuration</code> asadmin command like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin &gt; get-xmpp-notifier-configuration

Enabled  Noisy  Host          XMPP Port  Service Name            Username         Password  Security Disabled  Room ID
true     false  172.28.128.3  5222       conference.payara.fish  payara_notifier  payara    true               server</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="troubleshooting"><a class="anchor" href="#troubleshooting"></a>Troubleshooting</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you have correctly configured the XMPP notifier, it can be used to push notifications to your configured server. You can visualize the messages in a XMPP client of your choice. If you do not see any notification event messages in the client, check the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Is the XMPP notifier enabled?</p>
</li>
<li>
<p>Is the Notification Service itself enabled?</p>
</li>
<li>
<p>Is there a service configured to use the notifier? (e.g. the HealthCheck service)</p>
</li>
<li>
<p>Is the service configured to send notifications frequently enough to observe?</p>
</li>
<li>
<p>Have you enabled the service after configuring it?</p>
</li>
<li>
<p>Is the XMPP server correctly configured?</p>
</li>
<li>
<p>Is there a firewall between both servers that is correctly configured to allow sending messages in the respective port?</p>
</li>
<li>
<p>Are the room permissions configured correctly?</p>
</li>
<li>
<p>If using secure transport, is the server configured with a valid SSL certificate for its <em>FQDN</em>?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here&#8217;s a sample of how the notifications are visualized on a chat room using the <a href="https://www.igniterealtime.org/projects/spark/">Spark</a> XMPP client:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/notification-service/xmpp/spark-chat.png" alt="Spark Chat Room"></span></p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../../../_/js/site.js"></script>
<script async src="../../../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../../../_/js/vendor/docSearch.js"></script>
  </body>
</html>
