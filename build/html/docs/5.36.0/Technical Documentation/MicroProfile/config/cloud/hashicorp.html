<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HashiCorp Secrets Config Source :: Payara Documentation Preview</title>
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../../../../../../_/css/site.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@alpha" />
    <meta name="docsearch:version" content="5.36.0" />
  </head>
  <body class="article">
  <header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../../../..">Payara Documentation Preview</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-item hide-for-print">
        Version: <div class="page-versions">
  <button class="version-menu-toggle single-version" title="Current version">5.36.0</button>
</div>

      </div>
      <div class="navbar-item hide-for-print">
            <div id="search-input-container">
    </div>
      </div>

      <div class="navbar-end">
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://www.payara.fish/products/downloads/">Download</a>
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary enterprise" href="../../../../../../../enterprise">Documentation for Payara Enterprise</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="5.36.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">docs</span>
    <span class="version">5.36.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../../index.html">5.36.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../Overview.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../../index.html">docs</a></li>
    <li><a href="hashicorp.html">HashiCorp Secrets Config Source</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/alanroth/Workspace/Payara-Documentation/docs/modules/ROOT/pages/Technical%20Documentation/MicroProfile/config/cloud/hashicorp.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">HashiCorp Secrets Config Source</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The HashiCorp Secrets Config Source takes configuration properties from HashiCorp Vault. You can learn more about HashiCorp on: <a href="https://www.vaultproject.io/" class="bare">https://www.vaultproject.io/</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisite"><a class="anchor" href="#_prerequisite"></a>Prerequisite</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This documentation assumes the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You have successfully installed the HashiCorp Vault and have a running Vault server</p>
</li>
<li>
<p>You are familiar with most, if not all, of the HashiCorp Vault technology and terminology. If not please read through their documentation before you attempt to use HashiCorp Secrets Config Source</p>
</li>
<li>
<p>Your HashiCorp Vault is unsealed</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Hashicorp config source only supports the Vault KV Secrets Engine.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration"><a class="anchor" href="#configuration"></a>Configuration in Payara Server</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can configure HashiCorp Secrets Config Source either via the admin console or the <em>asadmin</em> utility. You&#8217;ll need a client token, the KV Secrets Engine API version, Vault&#8217;s address represented as URL and port, the path where the KV Secrets Engine is enabled and the path where your secrets are stored.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By default, the KV Secrets Engine is enabled at the /secret path in Vault.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_from_the_admin_console"><a class="anchor" href="#_from_the_admin_console"></a>From the Admin Console</h3>
<div class="paragraph">
<p>To configure the <code>HASHICORP_VAULT_TOKEN</code> password alias from the admin console, refer to the <a href="#documentation/payara-server/password-aliases/password-alias-admin-console-commands.adoc" class="page unresolved">Password Aliases Admin Console configuration</a> guide.</p>
</div>
<div class="paragraph">
<p>To configure the config source from the admin console, go to <code>Configs</code> &#8594; <code>your-config</code> &#8594; <code>MicroProfile</code> &#8594; <code>Config</code> &#8594; <code>HashiCorp Secrets</code>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../../_images/microprofile/config/cloud/hashicorp/admin-console-config.png" alt="Payara Server Administration Console configuration route"></span></p>
</div>
<div class="paragraph">
<p>From here you can select the KV Secrets Engine API version you want to use, configure the vault address, the path where the KV Secrets Engine is enabled and the path where your secrets are stored. You can also decide whether to apply these changes dynamically or on the next server restart. If the config source is enabled or disabled dynamically it will take effect across the server immediately.</p>
</div>
</div>
<div class="sect2">
<h3 id="_from_the_command_line"><a class="anchor" href="#_from_the_command_line"></a>From the Command Line</h3>
<div class="paragraph">
<p>To configure the <code>HASHICORP_VAULT_TOKEN</code> password alias from the admin console, refer to the <a href="#documentation/payara-server/password-aliases/password-alias-admin-console-commands.adoc" class="page unresolved">Password Aliases Admin Console configuration</a> guide.</p>
</div>
<div class="paragraph">
<p>To configure the HashiCorp Secrets Config Source from the command line, use the <code>set-hashicorp-config-source-configuration</code> asadmin command, specifying the required parameters like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin&gt; set-hashicorp-config-source-configuration --enabled true --dynamic true --api-version 2 --vault-address https://127.0.0.1:8200 --secrets-engine-path secret --secrets-path my-secret</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>--enabled</code> and <code>--dynamic</code> options to enable or disable the HashiCorp Secrets Config Source on demand.</p>
</div>
<div class="paragraph">
<p>Also, you can retrieve the current configuration for the HashiCorp Secrets Config Source using the <code>get-hashicorp-config-source-configuration</code> asadmin command like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin&gt; get-hashicorp-config-source-configuration

Enabled  API Version  Secrets Engine Path  Secrets Path  Vault Address
true     2            secret               my-secret     https://127.0.0.1:8200</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_usage"><a class="anchor" href="#_usage"></a>Usage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Provided that all of the above sections are configured correctly, the secrets can be injected into any applicable MicroProfile Config injection point as with any other Config Source. The secrets can also be fetched, created and deleted using the asadmin utility.</p>
</div>
<div class="paragraph">
<p>To fetch a secret form a HashiCorp Vault:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin&gt; get-config-property --source cloud --sourcename hashicorp --propertyname mysecret</code></pre>
</div>
</div>
<div class="paragraph">
<p>To create or change a secret from a HashiCorp Vault:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin&gt; set-config-property --source cloud --sourcename hashicorp --propertyname mysecret --propertyValue secretvalue</code></pre>
</div>
</div>
<div class="paragraph">
<p>To delete a secret from a HashiCorp Vault:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">asadmin&gt; delete-config-property --source cloud --sourcename hashicorp --propertyname mysecret</code></pre>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../../../_/js/site.js"></script>
<script async src="../../../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../../../_/js/vendor/docSearch.js"></script>
  </body>
</html>
