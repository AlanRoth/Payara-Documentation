<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Payara Server Managed Arquillian Container :: Payara Documentation Preview</title>
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../../../../../../_/css/site.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@alpha" />
    <meta name="docsearch:version" content="5.36.0" />
  </head>
  <body class="article">
  <header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../../../..">Payara Documentation Preview</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-item hide-for-print">
        Version: <div class="page-versions">
  <button class="version-menu-toggle single-version" title="Current version">5.36.0</button>
</div>

      </div>
      <div class="navbar-item hide-for-print">
            <div id="search-input-container">
    </div>
      </div>

      <div class="navbar-end">
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://www.payara.fish/products/downloads/">Download</a>
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary enterprise" href="../../../../../../../enterprise">Documentation for Payara Enterprise</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="5.36.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">docs</span>
    <span class="version">5.36.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../../index.html">5.36.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../Overview.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../../index.html">docs</a></li>
    <li><a href="payara-server-managed.html">Payara Server Managed Arquillian Container</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/alanroth/Workspace/ondro-poc/docs/modules/ROOT/pages/Technical%20Documentation/Ecosystem/Connector%20Suites/arquillian-containers/payara-server-managed.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Payara Server Managed Arquillian Container</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The Payara Server Managed Arquillian container is remote container same as a
 Payara Server Remote Arquillian Container but in addition, its lifecycle
 (startup/shutdown) is managed by Arquillian and run as a separate process for
 integration testing.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="usage"><a class="anchor" href="#usage"></a>Usage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Payara Server Managed Arquillian container can be found on Maven Central,
and can be included in your project using the following Maven coordinates:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;dependency&gt;
  &lt;groupId&gt;fish.payara.arquillian&lt;/groupId&gt;
  &lt;artifactId&gt;arquillian-payara-server-managed&lt;/artifactId&gt;
  &lt;version&gt;${version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can find the latest artifact version <a href="https://mvnrepository.com/artifact/fish.payara.arquillian/arquillian-payara-server-managed">from here</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configure"><a class="anchor" href="#configure"></a>Configuring the Container</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The container can be configured via the arquillian.xml using the standard <a href="http://arquillian.org/arquillian-core/#container-configuration">Arquillian Container Configuration</a> mechanism.</p>
</div>
<div class="paragraph">
<p>The following configuration options are required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>payaraHome</code> - The local Payara installation directory. Can be also set using the <code>payara.home</code> system property.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following Arquillian Container configuration options are available:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Configuration Options</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 80%;">
<col style="width: 10%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>adminHost</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The host to be used to access Payara Admin API.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>localhost</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>adminHttps</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">You can use it to specify whether the http or https protocol shall be used
to access the DAS. The property value can be true or false.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>adminPort</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port to be used to access Payara Admin API.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>4848</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>adminUser</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the admin user of your DAS. If omitted, no authentication will be used to access the DAS. In this case the <code>adminPassword</code> property should also be empty.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>adminPassword</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password of the admin user of your DAS. Cannot be omitted if you declare the admin user. If no authentication will be used to access the DAS you must have empty password for your admin user of your domain.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>allowConnectingToRunningServer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allow Arquillian to use an already running Payara instance and skips <code>start-domain</code> command invocation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>authorisation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, basic access authentication is enabled. And indicates that remote server requires an <code>adminUser</code> &amp; <code>adminPassword</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>debug</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Starts the server in debug mode using standard Payara debug port.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>domain</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Payara domain to use or the default domain if not specified.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the default domain</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>enableH2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Starts/Stops the registered H2 server using standard H2 port.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ignoreCertificates</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to <code>true</code>, SSL certificate correctness is ignored. This is useful for Docker images / TestContainers when certificates are not easily matched to internally generated ones and host names are also very hard to match.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>libraries</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comma-separated list of library JAR files. Specify the library JAR files by their relative or absolute paths. Specify relative paths relative to <code>domain-dir/lib/applibs</code>. The libraries are made available to the application in the order specified.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>outputToConsole</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Show the output of the admin commands on the console.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>payaraHome</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The local Payara installation directory. Required.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of the <code>payara.home</code> system property.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>properties</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional keyword-value pair that specify additional properties for the deployment. The available properties are determined by the implementation of the component that is being deployed.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>target</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Payara has a notion of a target, which specifies the target to which you are
deploying. We use the "target" as property key with the same semantics as the standard
Payara utilities do.</p>
<p class="tableblock">Valid values of the target are:</p>
<p class="tableblock"> - server: Deploys the component to the default Admin Server instance (on your DAS server). This is the default value if the property is omitted.</p>
<p class="tableblock"> - instance_name: Deploys the component to the specified stand-alone sever instance, which may be on the same hosts or can be on a different one as the DAS server.</p>
<p class="tableblock"> - cluster_name: Deploys the component to every server instance in the cluster. They can be on the same or on several other hosts as the DAS server. Note: Arquillian use only one instance to run the test case.</p>
<p class="tableblock">The domain name as a target is not a reasonable deployment scenario in case of testing.</p>
<p class="tableblock">The HOST address and port numbers of the test server instance used by Arquillian
(determined by the target property) been retrieved automatically from the DAS server.
You have to make them accessible for your test environment (consider any firewall or
proxy configuration).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to <code>osgi</code>, the component is packaged as an OSGi bundle. If the component is packaged as a regular archive, do not set this option.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The context root that will be used to run the tests is also retrieved automatically from the DAS server. If you do not have a <code>sun-web.xml</code>, <code>glassfish-web.xml</code> or <code>payara-web.xml</code> file in your web application, Payara will use the name of your deployment without the extension as context root. The same rule is applied for enterprise applications if there is no <code>application.xml</code> file. The jar test-deployments are treated as a web application. You can use the above standard GlassFish / Payara XML files as normal to declare your context root to be applied. You should consider the above description to avoid any conflict with your already deployed web or enterprise applications in your administrative domain.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="configure-example"><a class="anchor" href="#configure-example"></a>Example Configuration</h3>
<div class="paragraph">
<p>To configure the Arquillian Container options, you need to use an <code>arquillian.xml</code> file placed on the test classpath. Here&#8217;s an example <code>arquillian.xml</code> file. It configures <code>adminPort</code> with a static value. It configures <code>adminPassword</code> as a value of a system property <code>my.admin.password</code>, which you can specify for example in the maven <code>surefire</code> plugin using the <code>systemPropertyVariables</code> option or on command line like <code>mvn -Dmy.admin.password=mypassword test</code>.</p>
</div>
<div class="listingblock">
<div class="title">Example <code>arquillian.xml</code> file</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;?xml version="1.0"?&gt;
&lt;arquillian xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xmlns="http://jboss.org/schema/arquillian"
            xsi:schemaLocation="http://jboss.org/schema/arquillian
                http://jboss.org/schema/arquillian/arquillian_1_0.xsd"&gt;

    &lt;container qualifier="payara" default="true"&gt;
        &lt;configuration&gt;
            &lt;property name="adminPort"&gt;4848&lt;/property&gt;
            &lt;property name="adminPassword"&gt;${my.admin.password}&lt;/property&gt;
        &lt;/configuration&gt;
    &lt;/container&gt;
&lt;/arquillian&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to configure more containers, you can switch between them by setting the <code>arquillian.launch</code> system property to the container&#8217;s qualifier. This is how you can do it with the maven <code>surefire</code> plugin (<code>my.admin.password</code> system property is used to set the <code>adminPassword</code> property in <code>arquillian.xml</code>):</p>
</div>
<div class="listingblock">
<div class="title">Example Surefire plugin configuration in a <code>pom.xml</code> file</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
    &lt;configuration&gt;
        &lt;systemPropertyVariables&gt;
            &lt;arquillian.launch&gt;payara&lt;/arquillian.launch&gt;
            &lt;payara.home&gt;/path/to/payara&lt;/payara.home&gt;
            &lt;my.admin.password&gt;mypassword&lt;/my.admin.password&gt;
        &lt;/systemPropertyVariables&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="automatic-download-example"><a class="anchor" href="#automatic-download-example"></a>Downloading Payara Server automatically from Maven</h3>
<div class="paragraph">
<p>You can configure your Maven project to automatically download and install the Payara Server needed by the Arquillian plugin.</p>
</div>
<div class="paragraph">
<p>To download and install Payara Server, you can use the Maven Dependency plugin as follows:</p>
</div>
<div class="listingblock">
<div class="title">Example Dependency plugin configuration in a <code>pom.xml</code> file</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;id&gt;unpack&lt;/id&gt;
            &lt;phase&gt;process-test-classes&lt;/phase&gt;
            &lt;goals&gt;
                &lt;goal&gt;unpack&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
                &lt;artifactItems&gt;
                    &lt;artifactItem&gt;
                        &lt;groupId&gt;fish.payara.distributions&lt;/groupId&gt;
                        &lt;artifactId&gt;payara&lt;/artifactId&gt;
                        &lt;version&gt;${payara.version}&lt;/version&gt;
                        &lt;type&gt;zip&lt;/type&gt;
                        &lt;overWrite&gt;false&lt;/overWrite&gt;
                        &lt;outputDirectory&gt;${project.build.directory}&lt;/outputDirectory&gt;
                    &lt;/artifactItem&gt;
                &lt;/artifactItems&gt;
            &lt;/configuration&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;
&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
    &lt;configuration&gt;
        &lt;systemPropertyVariables&gt;
            &lt;payara.home&gt;${project.build.directory}/payara5&lt;/payara.home&gt;
        &lt;/systemPropertyVariables&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../../../_/js/site.js"></script>
<script async src="../../../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../../../_/js/vendor/docSearch.js"></script>
  </body>
</html>
